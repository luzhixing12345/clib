
# gettext

文本域(Text Domain)是一个字符串,它用于将程序中的文本标记到不同的组中,以便进行本地化翻译.文本域通常对应于一个程序或库,其中包含该程序或库中要翻译的所有文本字符串.

GNU gettext 是一种用于本地化程序的工具链,其中包括以下工具:

- xgettext:从源代码中提取文本域和字符串,生成 POT 文件.
- msginit:创建一个新的 PO 文件,其中包含翻译字符串的空白条目.
- msgmerge:更新一个 PO 文件,以便包含其他语言版本的翻译字符串.
- msgfmt:将 PO 文件编译为 MO 文件,其中包含翻译字符串的二进制表示形式.
- gettext:在程序运行时将字符串翻译为特定的语言.

在编写程序时,你需要在程序中标记所有要进行本地化翻译的字符串,以便 xgettext 工具可以将它们提取到 POT 文件中.标记字符串的方法是使用 gettext 宏.gettext 宏的参数是一个字符串字面量,它可以是一个简单的字符串,也可以是一个带有文本域的字符串.

例如,在 C 语言中,你可以使用以下语句标记一个字符串:

```c
printf(_("Hello, world!\n"));
```

在这里,"Hello, world!\n" 是一个要进行本地化的字符串,gettext 宏将其封装在一个带有默认文本域的字符串中,并返回一个本地化的版本.

在程序中使用 gettext 宏时,你需要使用 gettext 系列函数在程序运行时进行本地化.这些函数使用当前的本地化设置来将字符串翻译为特定的语言.如果当前的本地化设置不可用,或者没有找到与指定文本域匹配的翻译字符串,那么函数将返回原始的字符串字面量.

gettext 宏和 gettext 系列函数的实现依赖于一个名为 gettext 的库.该库包含一些数据结构和函数,用于在运行时查找和加载翻译字符串.gettext 宏和 gettext 系列函数的实现通常也依赖于一些系统特定的库和函数,例如 libintl 库和 setlocale 函数.